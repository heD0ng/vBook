(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{407:function(v,_,e){"use strict";e.r(_);var a=e(7),t=Object(a.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"重绘与回流"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#重绘与回流"}},[v._v("#")]),v._v(" 重绘与回流")]),v._v(" "),_("p",[v._v("重绘与回流是浏览器渲染的时候进行的操作，当页面内容发生改变的时候，就会触发重绘或者回流")]),v._v(" "),_("h2",{attrs:{id:"重绘"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#重绘"}},[v._v("#")]),v._v(" 重绘")]),v._v(" "),_("p",[v._v("当渲染树中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如"),_("code",[v._v("background-color")]),v._v("，则就叫称为重绘"),_("code",[v._v("Repaint")]),v._v("，重绘不一定触发回流。")]),v._v(" "),_("h2",{attrs:{id:"回流"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#回流"}},[v._v("#")]),v._v(" 回流")]),v._v(" "),_("p",[v._v("当渲染树中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建，这就称为回流"),_("code",[v._v("Reflow")]),v._v(",有些地方也称为重排，可理解为重新布局。每个页面至少需要一次回流，就是在页面第一次加载的时候，这时候是一定会发生回流的，因为要构建渲染树，回流一定触发重绘。"),_("br"),v._v(" "),_("code",[v._v("Reflow")]),v._v("的成本比"),_("code",[v._v("Repaint")]),v._v("的成本高得多的多。"),_("code",[v._v("DOM Tree")]),v._v("里的每个结点都会有"),_("code",[v._v("reflow")]),v._v("方法，一个结点的"),_("code",[v._v("reflow")]),v._v("很有可能导致子结点，甚至父点以及同级结点的reflow。在一些高性能的电脑上也许还没什么，但是如果"),_("code",[v._v("reflow")]),v._v("发生在手机上，那么这个过程就会卡顿与耗电。")]),v._v(" "),_("h2",{attrs:{id:"触发"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#触发"}},[v._v("#")]),v._v(" 触发")]),v._v(" "),_("ul",[_("li",[v._v("当修改CSS样式的时候")]),v._v(" "),_("li",[v._v("当修改网页的默认字体时")]),v._v(" "),_("li",[v._v("当增加、删除、修改"),_("code",[v._v("DOM")]),v._v("结点时")]),v._v(" "),_("li",[v._v("当"),_("code",[v._v("Resize")]),v._v("窗口的时候，或是滚动的时候")]),v._v(" "),_("li",[v._v("当移动"),_("code",[v._v("DOM")]),v._v("的位置，或是做个动画的时候")])]),v._v(" "),_("h2",{attrs:{id:"优化"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#优化"}},[v._v("#")]),v._v(" 优化")]),v._v(" "),_("h3",{attrs:{id:"浏览器的优化"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的优化"}},[v._v("#")]),v._v(" 浏览器的优化")]),v._v(" "),_("p",[v._v("浏览器本身携带一些优化方式，浏览器会把回流和重绘的操作积攒一批，当操作达到一定数量或者到达时间阈值，然后做一次"),_("code",[v._v("reflow")]),v._v("，称为异步"),_("code",[v._v("reflow")]),v._v("或增量异步"),_("code",[v._v("reflow")]),v._v("。但是有些情况浏览器是不会这么做的，例如"),_("code",[v._v("resize")]),v._v("窗口，改变了页面默认的字体等等。对于这些操作，浏览器会马上进行"),_("code",[v._v("reflow")]),v._v("。")]),v._v(" "),_("h3",{attrs:{id:"最小化操作"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#最小化操作"}},[v._v("#")]),v._v(" 最小化操作")]),v._v(" "),_("p",[v._v("由于重绘和回流可能代价比较昂贵，因此最好就是可以减少它的发生次数，为了减少发生次数，我们可以合并多次对"),_("code",[v._v("DOM")]),v._v("和样式的修改，然后一次处理掉，或者将样式事先设计好，动态去改变"),_("code",[v._v("class")]),v._v("。")]),v._v(" "),_("h3",{attrs:{id:"离线修改dom"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#离线修改dom"}},[v._v("#")]),v._v(" 离线修改DOM")]),v._v(" "),_("p",[v._v("使用"),_("code",[v._v("documentFragment")]),v._v("对象在内存里操作"),_("code",[v._v("DOM")]),v._v("，在内存中的"),_("code",[v._v("DOM")]),v._v("修改就是让元素脱离文档流，当然是不会触发重绘的，将对"),_("code",[v._v("DOM")]),v._v("的所有修改批量完成，想怎么改就怎么改，然后将节点再放入文档流中，只触发一次回流。")]),v._v(" "),_("h3",{attrs:{id:"绝对定位"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#绝对定位"}},[v._v("#")]),v._v(" 绝对定位")]),v._v(" "),_("p",[v._v("对于复杂动画效果，由于会经常的非常频繁的引起回流重绘，可以使用绝对定位，让它脱离文档流，否则会引起父元素以及后续元素频繁的回流。")]),v._v(" "),_("h3",{attrs:{id:"避免多层内联样式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#避免多层内联样式"}},[v._v("#")]),v._v(" 避免多层内联样式")]),v._v(" "),_("p",[v._v("通过"),_("code",[v._v("style")]),v._v("属性动态设置样式是在操作一个很小的"),_("code",[v._v("DOM")]),v._v("片段，容易导致多次回流。避免设置多级内联样式，样式应该合并在一个外部类，这样当该元素的"),_("code",[v._v("class")]),v._v("属性可被操控时仅会产生一个"),_("code",[v._v("reflow")]),v._v("。")]),v._v(" "),_("h3",{attrs:{id:"末端改动"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#末端改动"}},[v._v("#")]),v._v(" 末端改动")]),v._v(" "),_("p",[v._v("尽可能在"),_("code",[v._v("DOM")]),v._v("树的最末端或者是层级较低的节点改变"),_("code",[v._v("class")]),v._v("，回流可以自上而下，或自下而上的回流的信息传递给周围的节点。回流是不可避免的，但可以减少其影响。末端节点或者低层级节点的修改可以限制回流的范围，使其影响尽可能少的节点，当然其也有可能引发大面积回流。")]),v._v(" "),_("h3",{attrs:{id:"平滑度换取速度"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#平滑度换取速度"}},[v._v("#")]),v._v(" 平滑度换取速度")]),v._v(" "),_("p",[_("code",[v._v("Opera")]),v._v("还建议我们牺牲平滑度换取速度，其意思是指若可能想每次"),_("code",[v._v("1")]),v._v("像素移动一个动画，但是如果此动画及随后的回流使用了"),_("code",[v._v("100%")]),v._v("的"),_("code",[v._v("CPU")]),v._v("，动画就会看上去是跳动的，因为浏览器正在与更新回流做斗争。动画元素每次移动"),_("code",[v._v("3")]),v._v("像素可能在非常快的机器上看起来平滑度低了，但它不会导致"),_("code",[v._v("CPU")]),v._v("在较慢的机器和移动设备中抖动。")]),v._v(" "),_("h3",{attrs:{id:"避免table布局"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#避免table布局"}},[v._v("#")]),v._v(" 避免TABLE布局")]),v._v(" "),_("p",[v._v("在布局完全建立之前，"),_("code",[v._v("table")]),v._v("经常需要多个关口，因为"),_("code",[v._v("table")]),v._v("是个很罕见的可以影响在它们之前已经进入的"),_("code",[v._v("DOM")]),v._v("元素的显示的元素。想象一下，因为表格最后一个单元格的内容过宽而导致纵列大小完全改变，这就是为什么所有的浏览器都逐步地不支持"),_("code",[v._v("table")]),v._v("表格的渲染。然而有另外一个原因为什么表格布局是很糟糕的主意，即使一些小的变化将导致表格"),_("code",[v._v("table")]),v._v("中的所有其他节点回流。")]),v._v(" "),_("h3",{attrs:{id:"css3硬件加速"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#css3硬件加速"}},[v._v("#")]),v._v(" CSS3硬件加速")]),v._v(" "),_("p",[_("code",[v._v("CSS3")]),v._v("硬件加速也就是"),_("code",[v._v("GPU")]),v._v("加速，可以"),_("code",[v._v("transform")]),v._v("、"),_("code",[v._v("opacity")]),v._v("、"),_("code",[v._v("filters")]),v._v("这些动画不会引起回流重绘，但是对于动画的其它属性，比如"),_("code",[v._v("background-color")]),v._v("这些，还是会引起回流重绘的，不过它还是可以提升这些动画的性能。但是也会有一些问题，如果为太多元素使用"),_("code",[v._v("css3")]),v._v("硬件加速，会导致内存占用较大，会有性能问题。在"),_("code",[v._v("GPU")]),v._v("渲染字体会导致抗锯齿无效。这是因为"),_("code",[v._v("GPU")]),v._v("和"),_("code",[v._v("CPU")]),v._v("的算法不同。因此如果不在动画结束的时候关闭硬件加速，会产生字体模糊。")]),v._v(" "),_("h2",{attrs:{id:"调试"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#调试"}},[v._v("#")]),v._v(" 调试")]),v._v(" "),_("p",[v._v("在很多浏览器的开发者工具中提供了渲染操作的性能分析，以谷歌浏览器为例，其"),_("code",[v._v("performance")]),v._v("就可以查看各构建过程的性能消耗，在"),_("code",[v._v("Rendering")]),v._v("中可以使用"),_("code",[v._v("Paint flashing")]),v._v("高亮重绘区域、"),_("code",[v._v("Layout Shift Regions")]),v._v("高亮页面进行交互的布局变化、"),_("code",[v._v("FPS meter")]),v._v("显示"),_("code",[v._v("FPS")]),v._v("帧率等操作来进行性能分析测试")]),v._v(" "),_("h2",{attrs:{id:"每日一题"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#每日一题"}},[v._v("#")]),v._v(" 每日一题")]),v._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[v._v("https://github.com/WindrunnerMax/EveryDay\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br")])]),_("h2",{attrs:{id:"参考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[v._v("#")]),v._v(" 参考")]),v._v(" "),_("div",{staticClass:"language- line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-text"}},[_("code",[v._v("https://www.cnblogs.com/lpl666/p/10545042.html\nhttps://www.cnblogs.com/chenyanlong/p/10551080.html\nhttps://www.zhangxinxu.com/wordpress/2010/01/%E5%9B%9E%E6%B5%81%E4%B8%8E%E9%87%8D%E7%BB%98%EF%BC%9Acss%E6%80%A7%E8%83%BD%E8%AE%A9javascript%E5%8F%98%E6%85%A2%EF%BC%9F/\n")])]),v._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[v._v("1")]),_("br"),_("span",{staticClass:"line-number"},[v._v("2")]),_("br"),_("span",{staticClass:"line-number"},[v._v("3")]),_("br")])])])}),[],!1,null,null,null);_.default=t.exports}}]);